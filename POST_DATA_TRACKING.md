# 📊 POST DATA TRACKING

**Complete breakdown of what data is stored for regular posts**

---

## 🎯 **STAGE 1: GENERATION (content_metadata table)**

When a post is generated by the AI:

### **Stored Data:**

#### **Core Identification:**
```
✅ id - Auto-generated integer ID
✅ decision_id - Unique UUID for this post
✅ decision_type - 'single' or 'thread'
✅ created_at - When generated
✅ updated_at - Last modification
```

#### **Content:**
```
✅ content - The actual tweet text
✅ thread_parts - For threads: ["tweet1", "tweet2", ...]
✅ thread_length - Number of tweets in thread (1-25)
```

#### **Generation Metadata:**
```
✅ generation_source - 'real' (live) or 'synthetic' (shadow)
✅ generator_name - Which generator created it (coach, provocateur, dataNerd, etc.)
✅ topic_cluster - Health topic category
✅ angle - The AI-generated angle
✅ tone - The AI-generated tone (educational, provocative, etc.)
✅ format_strategy - AI-generated format strategy
✅ raw_topic - Original topic for diversity tracking
```

#### **Style & Strategy:**
```
✅ style - Content style (educational, storytelling, etc.)
✅ bandit_arm - Strategy identifier for A/B testing
✅ timing_arm - Time slot identifier
✅ fact_source - Where facts came from
✅ hook_type - Type of hook used
✅ hook_pattern - Specific hook pattern
✅ cta_type - Call-to-action type
```

#### **Quality & Predictions:**
```
✅ quality_score - Our quality assessment (0-1)
✅ predicted_er - Expected engagement rate
✅ predicted_engagement - 'low', 'medium', 'high'
✅ novelty - How unique/novel (0-1)
✅ readability_score - How readable
✅ sentiment - Emotional tone (-1 to 1)
```

#### **Status Tracking:**
```
✅ status - 'queued', 'posted', 'skipped', 'failed'
✅ scheduled_at - When to post
✅ posted_at - When actually posted (null until posted)
✅ skip_reason - Why skipped (if applicable)
✅ error_message - Error details (if failed)
```

#### **Advanced Features:**
```
✅ embedding - Vector embedding for similarity (1536 dimensions)
✅ content_hash - Hash for duplicate detection
✅ features - JSONB with AI-extracted features
✅ experiment_id - A/B test identifier
✅ experiment_arm - 'control', 'variant_a', 'variant_b'
```

#### **Performance (filled after posting):**
```
✅ tweet_id - Actual Twitter tweet ID
✅ actual_likes - Real likes count
✅ actual_retweets - Real retweets count
✅ actual_replies - Real replies count
✅ actual_impressions - Real views count
✅ actual_engagement_rate - Calculated ER
✅ viral_score - Virality rating (0-100)
```

#### **Learning Metrics:**
```
✅ prediction_accuracy - How accurate our prediction was
✅ style_effectiveness - How well this style performed (0-100)
✅ hook_effectiveness - How well the hook worked (0-1)
✅ cta_effectiveness - How well the CTA worked (0-1)
✅ fact_resonance - How well facts resonated (0-1)
```

**Example:**
```json
{
  "decision_id": "abc-123-def",
  "content": "Blue light (480nm) hits ipRGC cells → SCN master clock → cortisol release...",
  "generator_name": "data_nerd",
  "topic_cluster": "circadian_rhythms",
  "angle": "mechanism_explanation",
  "tone": "educational",
  "quality_score": 0.87,
  "predicted_er": 0.03,
  "status": "queued",
  "scheduled_at": "2024-10-28T20:00:00Z"
}
```

---

## 🚀 **STAGE 2: POSTING (posted_decisions table)**

When the post is actually posted to Twitter:

### **Stored Data:**
```
✅ id - Auto-generated ID
✅ decision_id - Links back to content_metadata
✅ decision_type - 'single' or 'thread'
✅ content - The posted text
✅ tweet_id - Twitter's tweet ID
✅ target_tweet_id - If reply, what we replied to
✅ target_username - If reply, who we replied to
✅ bandit_arm - Strategy used
✅ timing_arm - Time slot used
✅ predicted_er - Expected engagement rate
✅ quality_score - Quality assessment
✅ topic_cluster - Topic category
✅ generation_source - 'real' or 'synthetic'
✅ posted_at - Exact timestamp posted
✅ created_at - Record creation
```

**Example:**
```json
{
  "decision_id": "abc-123-def",
  "tweet_id": "1234567890",
  "content": "Blue light (480nm) hits ipRGC cells...",
  "bandit_arm": "educational",
  "topic_cluster": "circadian_rhythms",
  "posted_at": "2024-10-28T20:00:15Z"
}
```

---

## 📈 **STAGE 3: METRICS COLLECTION (outcomes table)**

Performance metrics scraped from Twitter:

### **Stored Data:**
```
✅ id - Auto-generated ID
✅ decision_id - Links to our post
✅ tweet_id - Twitter tweet ID
✅ simulated - false=real metrics, true=synthetic (shadow mode)

ENGAGEMENT METRICS:
✅ impressions - How many people saw it
✅ likes - Like count
✅ retweets - Retweet count
✅ replies - Reply count
✅ bookmarks - Bookmark count
✅ quotes - Quote tweet count
✅ engagement_rate - Calculated ER (likes+RTs+replies+bookmarks)/impressions

TIMESTAMPS:
✅ collected_at - When metrics were scraped
✅ created_at - Record creation
```

**Example:**
```json
{
  "decision_id": "abc-123-def",
  "tweet_id": "1234567890",
  "impressions": 2450,
  "likes": 85,
  "retweets": 12,
  "replies": 6,
  "bookmarks": 18,
  "engagement_rate": 0.0494,
  "simulated": false,
  "collected_at": "2024-10-28T21:00:00Z"
}
```

---

## ⏱️ **STAGE 4: VELOCITY TRACKING (post_velocity_tracking table)**

Time-based performance tracking at specific checkpoints:

### **Tracked At:**
```
✅ 1 hour after posting
✅ 6 hours after posting
✅ 24 hours after posting
✅ 7 days after posting
```

### **Stored Data:**
```
✅ id - Auto-generated ID
✅ post_id - Links to our post
✅ tweet_id - Twitter tweet ID
✅ check_time - When this checkpoint was measured
✅ hours_after_post - 1, 6, 24, or 168 hours
✅ collection_phase - 'checkpoint_1h', 'checkpoint_6h', etc.

METRICS AT CHECKPOINT:
✅ likes - Likes at this time
✅ retweets - Retweets at this time
✅ replies - Replies at this time
✅ bookmarks - Bookmarks at this time
✅ views - Views at this time
✅ follower_count - Our follower count at this time
```

**Example:**
```json
{
  "post_id": "abc-123-def",
  "hours_after_post": 1,
  "likes": 12,
  "retweets": 2,
  "views": 450,
  "collection_phase": "checkpoint_1h",
  "check_time": "2024-10-28T21:00:00Z"
}
```

**This enables:**
- Engagement velocity analysis (how fast did it grow?)
- Peak performance timing (when did it peak?)
- Long-tail performance (does it keep growing?)

---

## 🎓 **STAGE 5: GENERATOR LEARNING (generator_performance table)**

Learning which generators perform best:

### **Stored Data:**
```
✅ generator_name - Which generator (coach, provocateur, etc.)
✅ total_posts - How many posts generated
✅ avg_engagement_rate - Average ER across all posts
✅ avg_likes - Average likes
✅ avg_retweets - Average retweets
✅ best_post_id - Best performing post
✅ best_engagement_rate - Best ER achieved
✅ trend - 'improving', 'declining', 'stable'
✅ last_updated - When stats were updated
```

**Example:**
```json
{
  "generator_name": "data_nerd",
  "total_posts": 45,
  "avg_engagement_rate": 0.0425,
  "avg_likes": 92,
  "best_post_id": "xyz-789",
  "best_engagement_rate": 0.0875,
  "trend": "improving"
}
```

---

## 🧪 **STAGE 6: A/B TESTING (bandit_arms table)**

Continuous learning through A/B testing:

### **Stored Data:**
```
✅ arm_name - Strategy name (e.g., "educational", "provocative")
✅ pulls - How many times used
✅ rewards - Total engagement received
✅ avg_reward - Average reward per use
✅ confidence_bound - Upper confidence bound
✅ last_pulled - Last time used
✅ created_at - When created
```

**This enables:**
- Multi-armed bandit optimization
- Automatic strategy selection
- Continuous performance improvement

---

## 📊 **COMPLETE DATA FLOW**

```
1. GENERATE POST
   └─ Store in content_metadata
      ├─ Content & metadata
      ├─ Generator used
      ├─ Topic/angle/tone
      ├─ Quality predictions
      └─ Embedding & features

2. POST TO TWITTER
   └─ Store in posted_decisions
      ├─ Posted timestamp
      ├─ Twitter tweet ID
      └─ Strategy used

3. COLLECT METRICS (multiple times)
   └─ Store in outcomes
      ├─ Impressions, likes, RTs
      ├─ Engagement rate
      └─ Timestamp of collection

4. TRACK VELOCITY
   └─ Store in post_velocity_tracking
      ├─ Metrics at 1h, 6h, 24h, 7d
      ├─ Growth velocity
      └─ Performance curves

5. LEARN & IMPROVE
   └─ Update generator_performance
      ├─ Generator effectiveness
      ├─ Best practices
      └─ Performance trends
   
   └─ Update bandit_arms
      ├─ Strategy performance
      ├─ Confidence scores
      └─ Automatic optimization
```

---

## 🎯 **WHAT THIS ENABLES**

### **Content Optimization:**
```
✅ Which generators produce best content
✅ Which topics get most engagement
✅ Which tones/angles work best
✅ Which posting times are optimal
✅ Which hooks drive engagement
```

### **Performance Analysis:**
```
✅ Engagement rate trends over time
✅ Viral potential scoring
✅ Content similarity detection (no duplicates)
✅ Prediction accuracy tracking
✅ Growth velocity analysis
```

### **Machine Learning:**
```
✅ Continuous strategy optimization
✅ Automatic A/B testing
✅ Generator performance ranking
✅ Topic effectiveness scoring
✅ Multi-armed bandit selection
```

### **Strategic Insights:**
```
✅ What content goes viral
✅ When to post for maximum reach
✅ Which formats work best (single vs thread)
✅ How to improve predictions
✅ What makes content effective
```

---

## 🔄 **METRICS UPDATE FREQUENCY**

### **Regular Scraping:**
```
✅ Metrics scraper runs every 10 minutes
✅ Prioritizes recent posts (last 3 days)
✅ Also scrapes historical posts (3-30 days old)
✅ Scrapes ~20 posts per cycle
```

### **Velocity Tracking:**
```
✅ 1-hour checkpoint (within 30 min window)
✅ 6-hour checkpoint (within 30 min window)
✅ 24-hour checkpoint (within 30 min window)
✅ 7-day checkpoint (within 30 min window)
```

### **Learning Updates:**
```
✅ Generator performance: Daily
✅ Bandit arms: After each post
✅ Topic analysis: Hourly
✅ Outcome predictions: Continuous
```

---

## 💾 **DATA RETENTION**

```
✅ content_metadata: Forever (core data)
✅ posted_decisions: Forever (posting history)
✅ outcomes: Forever (performance learning)
✅ post_velocity_tracking: Forever (velocity analysis)
✅ generator_performance: Updated continuously
✅ bandit_arms: Updated continuously
```

---

## ✅ **SUMMARY**

**YES, your post system stores EXTENSIVE data:**

### **Generation Stage:**
- Content, metadata, generator used
- Topic, angle, tone combinations
- Quality scores, predictions
- Embeddings, features

### **Posting Stage:**
- Posted timestamp, Twitter ID
- Strategy used, timing slot
- Content snapshot

### **Performance Stage:**
- All engagement metrics (likes, RTs, replies, etc.)
- Engagement rate, impressions
- Multiple collection points

### **Velocity Stage:**
- Growth rates at 1h, 6h, 24h, 7d
- Performance curves
- Peak timing analysis

### **Learning Stage:**
- Generator effectiveness
- Strategy performance
- A/B test results
- Continuous optimization

**This data powers:**
- ✅ Smart generator selection
- ✅ Topic optimization
- ✅ A/B testing & learning
- ✅ Performance prediction
- ✅ Content improvement
- ✅ Viral content identification

**Your post system is a complete machine learning pipeline!** 🚀
