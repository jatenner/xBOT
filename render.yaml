services:
  # Background Worker Service (Optimal for 24/7 Autonomous Bot)
  - type: worker
    name: snap2health-xbot
    runtime: node
    plan: starter
    region: oregon
    branch: main
    buildCommand: npm ci && npm run build
    startCommand: node dist/index.js
    envVars:
      - key: NODE_ENV
        value: production
      - key: TZ
        value: UTC
      - key: OPENAI_API_KEY
        sync: false
      - key: TWITTER_APP_KEY
        sync: false
      - key: TWITTER_APP_SECRET
        sync: false
      - key: TWITTER_ACCESS_TOKEN
        sync: false
      - key: TWITTER_ACCESS_SECRET
        sync: false
      - key: TWITTER_BEARER_TOKEN
        sync: false
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_SERVICE_ROLE_KEY
        sync: false
      - key: NEWS_API_KEY
        sync: false
      - key: DISABLE_BOT
        value: false
      - key: MAX_DAILY_TWEETS
        value: 280
    scaling:
      minInstances: 1
      maxInstances: 1

  # Alternative: Web Service with Health Check
  - type: web
    name: snap2health-xbot
    env: node
    plan: starter
    buildCommand: npm ci && npm run build
    startCommand: npm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3000
    healthCheckPath: /health
    autoDeploy: true
    branch: main
    rootDir: .
    
    # Environment variables that need to be set in Render dashboard:
    # TWITTER_API_KEY
    # TWITTER_API_SECRET
    # TWITTER_ACCESS_TOKEN
    # TWITTER_ACCESS_TOKEN_SECRET
    # TWITTER_BEARER_TOKEN
    # OPENAI_API_KEY
    # SUPABASE_URL (optional)
    # SUPABASE_ANON_KEY (optional)
    # NEWS_API_KEY (optional) 