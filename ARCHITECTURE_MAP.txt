# ONE-PAGE REPLY PIPELINE ARCHITECTURE MAP

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                         REPLY SYSTEM - WIRING PROOF                         â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ENTRY POINTS (ALL CONVERGE TO generateReplies())                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Admin API (PRODUCTION)        2. Scheduler (CRON)
   /admin/run/replyJob              JobManager.run()
          â”‚                                â”‚
          â–¼                                â–¼
   adminEndpoints.ts:49          jobManager.ts:10
   triggerReplyJob()              import { generateReplies }
          â”‚                                â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
3. CLI (TEST)              â”‚              4. Direct (FALLBACK)
   runReplyOnce.ts         â”‚                 bin/run-job.ts:80
          â”‚                â”‚                        â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚   src/jobs/replyJob.ts         â”‚
          â”‚   generateReplies()            â”‚
          â”‚   Line 149                     â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–º generateRealReplies() [Line 482]
                           â”‚                    â”‚
                           â”‚                    â–¼
                           â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚           â”‚  OPPORTUNITY SELECTION      â”‚
                           â”‚           â”‚  Lines 625-945              â”‚
                           â”‚           â”‚                             â”‚
                           â”‚           â”‚  SELECT FROM                â”‚
                           â”‚           â”‚  reply_opportunities        â”‚
                           â”‚           â”‚  WHERE replied_to = false   â”‚
                           â”‚           â”‚  AND fresh (<180 min)       â”‚
                           â”‚           â”‚  ORDER BY score DESC        â”‚
                           â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                    â”‚
                           â”‚                    â–¼
                           â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚           â”‚  FOR EACH OPPORTUNITY       â”‚
                           â”‚           â”‚  Lines 1074-1558            â”‚
                           â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                    â”‚
                           â”‚                    â”œâ”€â”€â–º ğŸ”’ GATE 1: Context Lock
                           â”‚                    â”‚    createContextSnapshot()
                           â”‚                    â”‚    Line 1398
                           â”‚                    â”‚    âœ“ Captures target tweet text
                           â”‚                    â”‚    âœ“ Calculates content hash
                           â”‚                    â”‚    âœ“ Ensures immutability
                           â”‚                    â”‚
                           â”‚                    â”œâ”€â”€â–º ğŸ”’ GATE 2: Semantic Gate
                           â”‚                    â”‚    checkSemanticGate()
                           â”‚                    â”‚    Line 1429
                           â”‚                    â”‚    âœ“ Keyword overlap check
                           â”‚                    â”‚    âœ“ Similarity score (0.0-1.0)
                           â”‚                    â”‚    âœ“ Blocks off-topic replies
                           â”‚                    â”‚
                           â”‚                    â”œâ”€â”€â–º ğŸ”’ GATE 3: Anti-Spam Guard
                           â”‚                    â”‚    checkAntiSpam()
                           â”‚                    â”‚    Line 1471
                           â”‚                    â”‚    âœ“ Detects spam patterns
                           â”‚                    â”‚    âœ“ Checks reply history
                           â”‚                    â”‚    âœ“ Prevents duplicate replies
                           â”‚                    â”‚
                           â”‚                    â”œâ”€â”€â–º ğŸ§  GENERATION ROUTER
                           â”‚                    â”‚    generateReplyContent()
                           â”‚                    â”‚    Line 1130
                           â”‚                    â”‚    âœ“ Phase 4 orchestrator (primary)
                           â”‚                    â”‚    âœ“ Strategic system (fallback)
                           â”‚                    â”‚    â›” BLOCKS thread generators
                           â”‚                    â”‚
                           â”‚                    â””â”€â”€â–º ğŸ’¾ QUEUE REPLY
                           â”‚                         queueReply()
                           â”‚                         Line 1726
                           â”‚                         âœ“ Stores ALL gate data in DB
                           â”‚                         âœ“ decision_id (UUID)
                           â”‚                         âœ“ target_tweet_content_snapshot
                           â”‚                         âœ“ target_tweet_content_hash
                           â”‚                         âœ“ semantic_similarity
                           â”‚                         âœ“ anti_spam_checks
                           â”‚                         âœ“ root_tweet_id
                           â”‚                         â””â”€â–º INSERT INTO content_metadata
                           â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º generateSyntheticReplies() [Line 457]
                                              â”‚
                                              â–¼
                                       â›” BLOCKED IN PRODUCTION
                                       (requires ALLOW_SYNTHETIC_REPLIES=true)
                                       âš ï¸  Bypasses ALL gates - TEST ONLY

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DATABASE (TRUTH SOURCE)                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚  content_metadata (VIEW)       â”‚
                           â”‚  Base: content_generation_     â”‚
                           â”‚        metadata_comprehensive  â”‚
                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                           â”‚  decision_id               UUIDâ”‚
                           â”‚  decision_type           'reply'â”‚
                           â”‚  content                    TEXTâ”‚
                           â”‚  status      'queued'/'blocked' â”‚
                           â”‚  target_tweet_id            TEXTâ”‚
                           â”‚  target_username            TEXTâ”‚
                           â”‚  target_tweet_content_      TEXTâ”‚ â† Context Lock
                           â”‚    snapshot                     â”‚
                           â”‚  target_tweet_content_hash  TEXTâ”‚ â† Immutability
                           â”‚  semantic_similarity        REALâ”‚ â† Relevance
                           â”‚  anti_spam_checks           JSONâ”‚ â† Safety
                           â”‚  root_tweet_id              TEXTâ”‚ â† Root Target
                           â”‚  scheduled_at                 TSâ”‚
                           â”‚  created_at                   TSâ”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ PostingQueue reads
                                       â”‚ (NO rehydration)
                                       â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POSTING FLOW (ALL PATHS CONVERGE HERE)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚  src/jobs/postingQueue.ts      â”‚
                           â”‚  processPostingQueue()         â”‚
                           â”‚  Line 45                       â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
                           SELECT * FROM content_metadata
                           WHERE status IN ('queued', 'ready')
                           AND scheduled_at <= NOW()
                                       â”‚
                                       â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚  FOR EACH decision             â”‚
                           â”‚  Line ~1640                    â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”œâ”€â–º IF decision_type = 'post'
                                       â”‚   â†’ postSingle() or postThread()
                                       â”‚
                                       â””â”€â–º IF decision_type = 'reply'
                                            â”‚
                                            â–¼
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                   â”‚  ğŸ”’ SAFETY CHECK            â”‚
                                   â”‚  Line 2081                  â”‚
                                   â”‚                             â”‚
                                   â”‚  Verify ALL gate data       â”‚
                                   â”‚  present in decision:       â”‚
                                   â”‚  â€¢ target_tweet_id          â”‚
                                   â”‚  â€¢ target_tweet_content_    â”‚
                                   â”‚    snapshot                 â”‚
                                   â”‚  â€¢ target_tweet_content_hashâ”‚
                                   â”‚  â€¢ semantic_similarity      â”‚
                                   â”‚                             â”‚
                                   â”‚  â›” IF MISSING:             â”‚
                                   â”‚    Block + Log              â”‚
                                   â”‚    Skip posting             â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â–¼ All data present
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                   â”‚  ğŸ”’ PRE-POST INVARIANTS     â”‚
                                   â”‚  checkReplyInvariantsPrePostâ”‚
                                   â”‚  Line 2082                  â”‚
                                   â”‚                             â”‚
                                   â”‚  â€¢ format_check             â”‚
                                   â”‚    (no thread markers)      â”‚
                                   â”‚  â€¢ length_check (<260 chars)â”‚
                                   â”‚  â€¢ root_check               â”‚
                                   â”‚    (is_root_tweet = true)   â”‚
                                   â”‚  â€¢ freshness_check          â”‚
                                   â”‚    (<180 min old)           â”‚
                                   â”‚  â€¢ context_lock_verify      â”‚
                                   â”‚    (hash matches)           â”‚
                                   â”‚  â€¢ pipeline_guard           â”‚
                                   â”‚    (no thread generators)   â”‚
                                   â”‚                             â”‚
                                   â”‚  â›” IF FAIL:                â”‚
                                   â”‚    Mark blocked             â”‚
                                   â”‚    Skip posting             â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â–¼ All checks pass
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                   â”‚  postReply()                â”‚
                                   â”‚  Line 3050                  â”‚
                                   â”‚                             â”‚
                                   â”‚  UltimateTwitterPoster      â”‚
                                   â”‚    .postReply()             â”‚
                                   â”‚                             â”‚
                                   â”‚  Uses data from DB row ONLY â”‚
                                   â”‚  (NO rehydration)           â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â–¼
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                   â”‚  âœ… Posted to Twitter       â”‚
                                   â”‚                             â”‚
                                   â”‚  1. Write receipt           â”‚
                                   â”‚  2. Update status='posted'  â”‚
                                   â”‚  3. Store tweet_id          â”‚
                                   â”‚  4. Log success             â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GATE COVERAGE MATRIX                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ Path          â”ƒ Context    â”ƒ Semantic   â”ƒ Anti-    â”ƒ Pre-Post   â”ƒ Status â”ƒ
â”ƒ               â”ƒ Lock       â”ƒ Gate       â”ƒ Spam     â”ƒ Check      â”ƒ        â”ƒ
â”£â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‹â”â”â”â”â”â”â”â”â”â”â”â”â•‹â”â”â”â”â”â”â”â”â”â”â”â”â•‹â”â”â”â”â”â”â”â”â”â”â•‹â”â”â”â”â”â”â”â”â”â”â”â”â•‹â”â”â”â”â”â”â”â”â”«
â”ƒ Admin API     â”ƒ     âœ…     â”ƒ     âœ…     â”ƒ    âœ…    â”ƒ     âœ…     â”ƒ  SAFE  â”ƒ
â”ƒ Scheduler     â”ƒ     âœ…     â”ƒ     âœ…     â”ƒ    âœ…    â”ƒ     âœ…     â”ƒ  SAFE  â”ƒ
â”ƒ CLI           â”ƒ     âœ…     â”ƒ     âœ…     â”ƒ    âœ…    â”ƒ     âœ…     â”ƒ  SAFE  â”ƒ
â”ƒ Direct        â”ƒ     âœ…     â”ƒ     âœ…     â”ƒ    âœ…    â”ƒ     âœ…     â”ƒ  SAFE  â”ƒ
â”ƒ Synthetic     â”ƒ     âŒ     â”ƒ     âŒ     â”ƒ    âŒ    â”ƒ   âš ï¸  Part â”ƒ BLOCKEDâ”ƒ
â”ƒ PostingQueue  â”ƒ Verifies   â”ƒ Verifies   â”ƒ Verifies â”ƒ     âœ…     â”ƒ  SAFE  â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”›

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GUARANTEES AFTER PATCHES                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. âœ… IMPOSSIBLE TO BYPASS GATES
   â€¢ Synthetic path blocked with runtime error
   â€¢ PostingQueue verifies gate data present
   â€¢ Missing data â†’ automatic block + skip

2. âœ… NO THREAD GENERATORS IN REPLY MODE
   â€¢ Pipeline guard checks generation_source
   â€¢ orchestratorRouter blocks thread generators for decision_type='reply'
   â€¢ Runtime assertion in postingQueue

3. âœ… FULL AUDIT TRAIL
   â€¢ ALL decisions store: context snapshot, hash, semantic score, anti-spam result
   â€¢ Blocked decisions store: reason, guard results, error message
   â€¢ Grep-friendly logs with decision_id throughout

4. âœ… NO REHYDRATION
   â€¢ PostingQueue reads decision row from DB
   â€¢ Uses target_tweet_content_snapshot (not re-fetching)
   â€¢ Hash verification ensures immutability

5. âœ… FAIL-CLOSED BEHAVIOR
   â€¢ Gate failure â†’ mark blocked + continue (not crash)
   â€¢ Missing data â†’ mark blocked + continue (not crash)
   â€¢ Invariant failure â†’ mark blocked + continue (not crash)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEPLOYMENT STATUS                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Patch 1: Synthetic replies blocked (replyJob.ts:457)
âœ… Patch 2: Runtime safety check added (postingQueue.ts:2081)
âœ… Patch 3: Documentation added (replyJob.ts:1)

ğŸ”„ Pending: Deploy to Railway

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VERIFICATION COMMANDS                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# Test synthetic block
NODE_ENV=production ts-node -e "
  require('./src/jobs/replyJob').generateSyntheticReplies()
    .catch(e => console.log('âœ… BLOCKED:', e.message))
"

# Check all decisions have gate data
psql "$DATABASE_URL" -c "
  SELECT COUNT(*) as missing_gate_data
  FROM content_metadata
  WHERE decision_type = 'reply'
    AND status = 'queued'
    AND (target_tweet_content_hash IS NULL OR semantic_similarity IS NULL);
"

# Check logs for safety blocks
railway logs --lines 100 | grep "SAFETY CHECK\|BLOCKED.*missing_gate_data"

# Verify no thread generators
grep -r "strategic_multi_generator\|thread_generator" src/jobs/replyJob.ts
```

